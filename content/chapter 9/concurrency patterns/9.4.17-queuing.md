---
title: 9.4.17 الگو Queuing
slug: go-concurrency-pattern-queuing
weight: 177017
mermaid: "true"
---


## 9.4.17.1 توضیحات

الگوی "صف" در زبان گو الگویی است که در آن از یک گوروتین برای بافر کردن و مدیریت ترتیب مقادیر ارسال شده و دریافت شده از یک کانال استفاده می شود.

## 9.4.17.2 دیاگرام


{{< mermaid >}}
flowchart TD
    A[شروع] --> B[تولیدکننده‌ها]
    B -->|افزودن درخواست‌ها| C[صف درخواست‌ها]
    C -->|ارسال به مصرف‌کننده| D[مصرف‌کننده‌ها]
    D --> E[پردازش درخواست‌ها]
    E --> F[پایان]
{{< /mermaid >}}


## 9.4.17.3 نمونه کد

```go
package main

import "fmt"

func main() {
	// Declare the queue channel with a buffer size of 5
	queue := make(chan int, 5)

	// Send values to the queue
	go func() {
		for i := 0; i < 10; i++ {
			queue <- i
			fmt.Println("Sent:", i)
		}
		close(queue)
	}()

	// Receive values from the queue
	for value := range queue {
		fmt.Println("Received:", value)
	}
}
```

```shell
$ go run main.go
Sent: 0
Received: 0
Received: 1
Sent: 1
Sent: 2
Sent: 3
Sent: 4
Sent: 5
Sent: 6
Sent: 7
Received: 2
Received: 3
Received: 4
Received: 5
Received: 6
Received: 7
Received: 8
Sent: 8
Sent: 9
Received: 9
```


در کد فوق ما یک کانال بافر شده با ظرفیت ۵ ایجاد کردیم. سپس داخل یک گوروتین یک حلقه قرار داده از i تا ۱۰ و مقدار i را به کانال فرستادیم و در نهایت کانال را بستیم. سپس یکی حلقه for-range برروی کانال قرار دادیم و مقادیر را دریافت کردیم و سپس چاپ کردیم.

## 9.4.17.4 کاربردها


- **زمان‌بندی کار (Task scheduling):** یک کانال می‌تواند به عنوان صف برای نگه‌داشتن وظایفی که باید توسط یک گوروتین worker اجرا و استفاده شود. کارگر وظایف را به ترتیبی که اضافه شده اند از صف می گیرد و آنها را پردازش می کند.
- **بافر کردن داده ها:** یک کانال می تواند به عنوان یک بافر برای نگهداری داده های ورودی قبل از پردازش توسط گوروتین دیگر استفاده شود. این می تواند زمانی مفید باشد که سرعت پردازش داده ها کندتر از سرعت دریافت آن باشد.
- **Throttling:** یک کانال می تواند به عنوان یک صف برای محدود کردن سرعت پردازش داده ها توسط یک گوروتین استفاده شود. با افزودن یک بافر به کانال، زمانی که بافر پر شود، گوروتین ارسال کننده مسدود می شود و به طور موثر سرعت ارسال داده ها را کاهش می دهد.
- **Logging:** یک کانال می تواند به عنوان یک صف برای نگهداری پیام های گزارشی که باید در یک فایل نوشته شود یا از طریق شبکه ارسال شود استفاده شود. کارگر گوروتین پیام‌های گزارش را به ترتیبی که اضافه شده‌اند از صف می‌گیرد و در فایل گزارش می‌نویسد.
- **Multi-threading:** یک کانال می تواند به عنوان یک صف برای به اشتراک گذاری داده ها بین گوروتین های مختلف و مدیریت همزمانی برنامه استفاده شود.

